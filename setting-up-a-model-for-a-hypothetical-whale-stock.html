<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Setting up a model for a hypothetical whale stock | Building models using the Gadget framework</title>
  <meta name="description" content="10 Setting up a model for a hypothetical whale stock | Building models using the Gadget framework" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Setting up a model for a hypothetical whale stock | Building models using the Gadget framework" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Setting up a model for a hypothetical whale stock | Building models using the Gadget framework" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="marine-mammals.html"/>
<link rel="next" href="processing-input-data-with-mfdb.html"/>
<script src="assets/jquery-2.2.3/jquery.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="assets/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="assets/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.0/anchor-sections.js"></script>
<script src="assets/htmlwidgets-1.5.2/htmlwidgets.js"></script>
<link href="assets/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="assets/datatables-binding-0.16/datatables.js"></script>
<link href="assets/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="assets/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="assets/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="assets/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="assets/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="./">Building Gadget models</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About this course</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#course-objectives"><i class="fa fa-check"></i><b>1.1</b> Course objectives</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#your-a-priori-homework"><i class="fa fa-check"></i><b>1.2</b> Your a priori homework</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#reading-material"><i class="fa fa-check"></i><b>1.3</b> Reading material</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="general-context-of-gadget.html"><a href="general-context-of-gadget.html"><i class="fa fa-check"></i><b>2</b> General context of Gadget</a><ul>
<li class="chapter" data-level="2.1" data-path="general-context-of-gadget.html"><a href="general-context-of-gadget.html#gadget-a-toolbox-for-fisheries-stock-assessments"><i class="fa fa-check"></i><b>2.1</b> Gadget – a toolbox for fisheries stock assessments</a></li>
<li class="chapter" data-level="2.2" data-path="general-context-of-gadget.html"><a href="general-context-of-gadget.html#description-of-gadget"><i class="fa fa-check"></i><b>2.2</b> Description of Gadget</a></li>
<li class="chapter" data-level="2.3" data-path="general-context-of-gadget.html"><a href="general-context-of-gadget.html#this-course"><i class="fa fa-check"></i><b>2.3</b> This course</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html"><i class="fa fa-check"></i><b>3</b> Introduction to Tidyverse</a><ul>
<li class="chapter" data-level="3.1" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#idealogy-behind-r-for-data-science"><i class="fa fa-check"></i><b>3.1</b> Idealogy behind R for Data Science</a></li>
<li class="chapter" data-level="3.2" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#the-foundation-tibbles-tidy-data-and-piping"><i class="fa fa-check"></i><b>3.2</b> The foundation: tibbles, tidy data, and piping</a><ul>
<li class="chapter" data-level="3.2.1" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#tibbles"><i class="fa fa-check"></i><b>3.2.1</b> Tibbles</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#tidy-data"><i class="fa fa-check"></i><b>3.3</b> Tidy data</a><ul>
<li class="chapter" data-level="3.3.1" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#piping"><i class="fa fa-check"></i><b>3.3.1</b> Piping</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#the-power-of-tidyverse-all-you-need-in-a-handful-of-functions"><i class="fa fa-check"></i><b>3.4</b> The power of tidyverse: all you need in a handful of functions</a></li>
<li class="chapter" data-level="3.5" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#plotting-in-tidyverse"><i class="fa fa-check"></i><b>3.5</b> Plotting in tidyverse</a><ul>
<li class="chapter" data-level="3.5.1" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#ggplot-key-components"><i class="fa fa-check"></i><b>3.5.1</b> ggplot: Key components</a></li>
<li class="chapter" data-level="3.5.2" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#aesthetic"><i class="fa fa-check"></i><b>3.5.2</b> aesthetic</a></li>
<li class="chapter" data-level="3.5.3" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#facetting"><i class="fa fa-check"></i><b>3.5.3</b> Facetting</a></li>
<li class="chapter" data-level="3.5.4" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#adding-layers"><i class="fa fa-check"></i><b>3.5.4</b> Adding layers</a></li>
<li class="chapter" data-level="3.5.5" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#add-a-line-to-a-scatterplot"><i class="fa fa-check"></i><b>3.5.5</b> Add a line to a scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#statistical-summary-graphs"><i class="fa fa-check"></i><b>3.6</b> Statistical summary graphs</a></li>
<li class="chapter" data-level="3.7" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#other-statistical-summaries"><i class="fa fa-check"></i><b>3.7</b> Other statistical summaries</a></li>
<li class="chapter" data-level="3.8" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#some-controls"><i class="fa fa-check"></i><b>3.8</b> Some controls</a><ul>
<li class="chapter" data-level="3.8.1" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#labels"><i class="fa fa-check"></i><b>3.8.1</b> labels</a></li>
<li class="chapter" data-level="3.8.2" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#legend-position"><i class="fa fa-check"></i><b>3.8.2</b> Legend position</a></li>
<li class="chapter" data-level="3.8.3" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#breaks"><i class="fa fa-check"></i><b>3.8.3</b> breaks</a></li>
<li class="chapter" data-level="3.8.4" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#limits"><i class="fa fa-check"></i><b>3.8.4</b> limits</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="introduction-to-tidyverse.html"><a href="introduction-to-tidyverse.html#further-readings"><i class="fa fa-check"></i><b>3.9</b> Further readings</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="getting-started-with-the-gadget-framework.html"><a href="getting-started-with-the-gadget-framework.html"><i class="fa fa-check"></i><b>4</b> Getting started with the Gadget framework</a><ul>
<li class="chapter" data-level="4.1" data-path="getting-started-with-the-gadget-framework.html"><a href="getting-started-with-the-gadget-framework.html#what-is-rgadget"><i class="fa fa-check"></i><b>4.1</b> What is Rgadget?</a></li>
<li class="chapter" data-level="4.2" data-path="getting-started-with-the-gadget-framework.html"><a href="getting-started-with-the-gadget-framework.html#using-rgadget"><i class="fa fa-check"></i><b>4.2</b> Using Rgadget</a></li>
<li class="chapter" data-level="4.3" data-path="getting-started-with-the-gadget-framework.html"><a href="getting-started-with-the-gadget-framework.html#creating-model-input-files"><i class="fa fa-check"></i><b>4.3</b> Creating model input files</a><ul>
<li class="chapter" data-level="4.3.1" data-path="getting-started-with-the-gadget-framework.html"><a href="getting-started-with-the-gadget-framework.html#time-file"><i class="fa fa-check"></i><b>4.3.1</b> Time file</a></li>
<li class="chapter" data-level="4.3.2" data-path="getting-started-with-the-gadget-framework.html"><a href="getting-started-with-the-gadget-framework.html#area-file"><i class="fa fa-check"></i><b>4.3.2</b> Area file</a></li>
<li class="chapter" data-level="4.3.3" data-path="getting-started-with-the-gadget-framework.html"><a href="getting-started-with-the-gadget-framework.html#stockfiles"><i class="fa fa-check"></i><b>4.3.3</b> Stockfiles</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="getting-started-with-the-gadget-framework.html"><a href="getting-started-with-the-gadget-framework.html#starting-a-simulation"><i class="fa fa-check"></i><b>4.4</b> Starting a simulation</a></li>
<li class="chapter" data-level="4.5" data-path="getting-started-with-the-gadget-framework.html"><a href="getting-started-with-the-gadget-framework.html#gadget-variables"><i class="fa fa-check"></i><b>4.5</b> Gadget variables</a></li>
<li class="chapter" data-level="4.6" data-path="getting-started-with-the-gadget-framework.html"><a href="getting-started-with-the-gadget-framework.html#predation"><i class="fa fa-check"></i><b>4.6</b> Predation</a></li>
<li class="chapter" data-level="4.7" data-path="getting-started-with-the-gadget-framework.html"><a href="getting-started-with-the-gadget-framework.html#fleet-operations"><i class="fa fa-check"></i><b>4.7</b> Fleet operations</a><ul>
<li class="chapter" data-level="4.7.1" data-path="getting-started-with-the-gadget-framework.html"><a href="getting-started-with-the-gadget-framework.html#excercise"><i class="fa fa-check"></i><b>4.7.1</b> Excercise</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="getting-started-with-the-gadget-framework.html"><a href="getting-started-with-the-gadget-framework.html#recruitment"><i class="fa fa-check"></i><b>4.8</b> Recruitment</a><ul>
<li class="chapter" data-level="4.8.1" data-path="getting-started-with-the-gadget-framework.html"><a href="getting-started-with-the-gadget-framework.html#exercise-1"><i class="fa fa-check"></i><b>4.8.1</b> Exercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="defining-stock-interations.html"><a href="defining-stock-interations.html"><i class="fa fa-check"></i><b>5</b> Defining stock interations</a><ul>
<li class="chapter" data-level="5.1" data-path="defining-stock-interations.html"><a href="defining-stock-interations.html#fish-recruits-into-a-stock"><i class="fa fa-check"></i><b>5.1</b> Fish recruits into a stock</a><ul>
<li class="chapter" data-level="5.1.1" data-path="defining-stock-interations.html"><a href="defining-stock-interations.html#excercise-1"><i class="fa fa-check"></i><b>5.1.1</b> Excercise</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="defining-stock-interations.html"><a href="defining-stock-interations.html#spawning"><i class="fa fa-check"></i><b>5.2</b> Spawning</a><ul>
<li class="chapter" data-level="5.2.1" data-path="defining-stock-interations.html"><a href="defining-stock-interations.html#time-variables"><i class="fa fa-check"></i><b>5.2.1</b> Time variables</a></li>
<li class="chapter" data-level="5.2.2" data-path="defining-stock-interations.html"><a href="defining-stock-interations.html#excercise-2"><i class="fa fa-check"></i><b>5.2.2</b> Excercise</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="defining-stock-interations.html"><a href="defining-stock-interations.html#consumption"><i class="fa fa-check"></i><b>5.3</b> Consumption</a><ul>
<li class="chapter" data-level="5.3.1" data-path="defining-stock-interations.html"><a href="defining-stock-interations.html#excercise-3"><i class="fa fa-check"></i><b>5.3.1</b> Excercise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="building-complex-gadget-models.html"><a href="building-complex-gadget-models.html"><i class="fa fa-check"></i><b>6</b> Building complex Gadget models</a><ul>
<li class="chapter" data-level="6.1" data-path="building-complex-gadget-models.html"><a href="building-complex-gadget-models.html#defining-growth"><i class="fa fa-check"></i><b>6.1</b> Defining growth</a><ul>
<li class="chapter" data-level="6.1.1" data-path="building-complex-gadget-models.html"><a href="building-complex-gadget-models.html#growth"><i class="fa fa-check"></i><b>6.1.1</b> Growth</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="building-complex-gadget-models.html"><a href="building-complex-gadget-models.html#ling-stock-assessment-in-icelandic-waters"><i class="fa fa-check"></i><b>6.2</b> Ling stock assessment in Icelandic waters</a></li>
<li class="chapter" data-level="6.3" data-path="building-complex-gadget-models.html"><a href="building-complex-gadget-models.html#model-initiation"><i class="fa fa-check"></i><b>6.3</b> Model initiation</a><ul>
<li class="chapter" data-level="6.3.1" data-path="building-complex-gadget-models.html"><a href="building-complex-gadget-models.html#maturation-as-multi-stock-models"><i class="fa fa-check"></i><b>6.3.1</b> Maturation as multi-‘stock’ models</a></li>
<li class="chapter" data-level="6.3.2" data-path="building-complex-gadget-models.html"><a href="building-complex-gadget-models.html#initial-conditions"><i class="fa fa-check"></i><b>6.3.2</b> Initial conditions</a></li>
<li class="chapter" data-level="6.3.3" data-path="building-complex-gadget-models.html"><a href="building-complex-gadget-models.html#renewal"><i class="fa fa-check"></i><b>6.3.3</b> Renewal</a></li>
<li class="chapter" data-level="6.3.4" data-path="building-complex-gadget-models.html"><a href="building-complex-gadget-models.html#reference-weight"><i class="fa fa-check"></i><b>6.3.4</b> Reference Weight</a></li>
<li class="chapter" data-level="6.3.5" data-path="building-complex-gadget-models.html"><a href="building-complex-gadget-models.html#is-fished-eaten"><i class="fa fa-check"></i><b>6.3.5</b> Is fished / eaten</a></li>
<li class="chapter" data-level="6.3.6" data-path="building-complex-gadget-models.html"><a href="building-complex-gadget-models.html#set-up-fleets-using-catch-or-effort-data"><i class="fa fa-check"></i><b>6.3.6</b> Set up fleets using catch or effort data</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="building-complex-gadget-models.html"><a href="building-complex-gadget-models.html#run-the-simulation-using-pre-determined-parameters"><i class="fa fa-check"></i><b>6.4</b> Run the simulation using pre-determined parameters</a></li>
<li class="chapter" data-level="6.5" data-path="building-complex-gadget-models.html"><a href="building-complex-gadget-models.html#talking-points"><i class="fa fa-check"></i><b>6.5</b> Talking points</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="fitting-a-model-to-data.html"><a href="fitting-a-model-to-data.html"><i class="fa fa-check"></i><b>7</b> Fitting a model to data</a><ul>
<li class="chapter" data-level="7.1" data-path="fitting-a-model-to-data.html"><a href="fitting-a-model-to-data.html#introducing-likelihood-functions"><i class="fa fa-check"></i><b>7.1</b> Introducing likelihood functions</a></li>
<li class="chapter" data-level="7.2" data-path="fitting-a-model-to-data.html"><a href="fitting-a-model-to-data.html#incorporating-data-ling-case-study-cont."><i class="fa fa-check"></i><b>7.2</b> Incorporating data (Ling case study cont.)</a><ul>
<li class="chapter" data-level="7.2.1" data-path="fitting-a-model-to-data.html"><a href="fitting-a-model-to-data.html#exercise-3"><i class="fa fa-check"></i><b>7.2.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="fitting-a-model-to-data.html"><a href="fitting-a-model-to-data.html#setting-up-likelihood-components"><i class="fa fa-check"></i><b>7.3</b> Setting up likelihood components</a><ul>
<li class="chapter" data-level="7.3.1" data-path="fitting-a-model-to-data.html"><a href="fitting-a-model-to-data.html#setting-up-survey-indices"><i class="fa fa-check"></i><b>7.3.1</b> Setting up survey indices</a></li>
<li class="chapter" data-level="7.3.2" data-path="fitting-a-model-to-data.html"><a href="fitting-a-model-to-data.html#penalty-functions"><i class="fa fa-check"></i><b>7.3.2</b> Penalty functions</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="fitting-a-model-to-data.html"><a href="fitting-a-model-to-data.html#fitting-a-gadget-model-to-data"><i class="fa fa-check"></i><b>7.4</b> Fitting a Gadget model to data</a><ul>
<li class="chapter" data-level="7.4.1" data-path="fitting-a-model-to-data.html"><a href="fitting-a-model-to-data.html#create-starting-values"><i class="fa fa-check"></i><b>7.4.1</b> Create starting values</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="fitting-a-model-to-data.html"><a href="fitting-a-model-to-data.html#set-optimisation-routine"><i class="fa fa-check"></i><b>7.5</b> Set optimisation routine</a></li>
<li class="chapter" data-level="7.6" data-path="fitting-a-model-to-data.html"><a href="fitting-a-model-to-data.html#using-the-iterative-reweighting-function-to-fit-a-gadget-statistical-model"><i class="fa fa-check"></i><b>7.6</b> Using the iterative reweighting function to fit a Gadget statistical model</a></li>
<li class="chapter" data-level="7.7" data-path="fitting-a-model-to-data.html"><a href="fitting-a-model-to-data.html#visualize-gadget-statistical-model-fit"><i class="fa fa-check"></i><b>7.7</b> Visualize Gadget statistical model fit</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="defining-multi-area-models.html"><a href="defining-multi-area-models.html"><i class="fa fa-check"></i><b>8</b> Defining multi area models</a><ul>
<li class="chapter" data-level="8.1" data-path="defining-multi-area-models.html"><a href="defining-multi-area-models.html#alternate-structures-multiple-areas"><i class="fa fa-check"></i><b>8.1</b> Alternate structures: multiple areas</a><ul>
<li class="chapter" data-level="8.1.1" data-path="defining-multi-area-models.html"><a href="defining-multi-area-models.html#migration"><i class="fa fa-check"></i><b>8.1.1</b> Migration</a></li>
<li class="chapter" data-level="8.1.2" data-path="defining-multi-area-models.html"><a href="defining-multi-area-models.html#using-data-from-multiple-areas"><i class="fa fa-check"></i><b>8.1.2</b> Using data from multiple areas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="marine-mammals.html"><a href="marine-mammals.html"><i class="fa fa-check"></i><b>9</b> Marine mammals</a></li>
<li class="chapter" data-level="10" data-path="setting-up-a-model-for-a-hypothetical-whale-stock.html"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html"><i class="fa fa-check"></i><b>10</b> Setting up a model for a hypothetical whale stock</a><ul>
<li class="chapter" data-level="10.0.1" data-path="setting-up-a-model-for-a-hypothetical-whale-stock.html"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#run-gadget-and-set-initial-parameters"><i class="fa fa-check"></i><b>10.0.1</b> Run Gadget and set initial parameters</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="processing-input-data-with-mfdb.html"><a href="processing-input-data-with-mfdb.html"><i class="fa fa-check"></i><b>11</b> Processing input data with MFDB</a><ul>
<li class="chapter" data-level="11.1" data-path="processing-input-data-with-mfdb.html"><a href="processing-input-data-with-mfdb.html#working-with-data"><i class="fa fa-check"></i><b>11.1</b> Working with data</a></li>
<li class="chapter" data-level="11.2" data-path="processing-input-data-with-mfdb.html"><a href="processing-input-data-with-mfdb.html#description-of-the-mfdb-system"><i class="fa fa-check"></i><b>11.2</b> Description of the MFDB system</a><ul>
<li class="chapter" data-level="11.2.1" data-path="processing-input-data-with-mfdb.html"><a href="processing-input-data-with-mfdb.html#installing-mfdb"><i class="fa fa-check"></i><b>11.2.1</b> Installing MFDB</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="processing-input-data-with-mfdb.html"><a href="processing-input-data-with-mfdb.html#importing-data"><i class="fa fa-check"></i><b>11.3</b> Importing data</a><ul>
<li class="chapter" data-level="11.3.1" data-path="processing-input-data-with-mfdb.html"><a href="processing-input-data-with-mfdb.html#connect-to-database"><i class="fa fa-check"></i><b>11.3.1</b> Connect to database</a></li>
<li class="chapter" data-level="11.3.2" data-path="processing-input-data-with-mfdb.html"><a href="processing-input-data-with-mfdb.html#defining-taxonomies"><i class="fa fa-check"></i><b>11.3.2</b> Defining taxonomies</a></li>
<li class="chapter" data-level="11.3.3" data-path="processing-input-data-with-mfdb.html"><a href="processing-input-data-with-mfdb.html#define-areas-divisions"><i class="fa fa-check"></i><b>11.3.3</b> Define areas &amp; divisions</a></li>
<li class="chapter" data-level="11.3.4" data-path="processing-input-data-with-mfdb.html"><a href="processing-input-data-with-mfdb.html#define-sampling-types"><i class="fa fa-check"></i><b>11.3.4</b> Define sampling types</a></li>
<li class="chapter" data-level="11.3.5" data-path="processing-input-data-with-mfdb.html"><a href="processing-input-data-with-mfdb.html#define-vessel-taxonomy"><i class="fa fa-check"></i><b>11.3.5</b> Define vessel taxonomy</a></li>
<li class="chapter" data-level="11.3.6" data-path="processing-input-data-with-mfdb.html"><a href="processing-input-data-with-mfdb.html#define-tow-taxonomy"><i class="fa fa-check"></i><b>11.3.6</b> Define tow taxonomy</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="processing-input-data-with-mfdb.html"><a href="processing-input-data-with-mfdb.html#importing-data-1"><i class="fa fa-check"></i><b>11.4</b> Importing data</a><ul>
<li class="chapter" data-level="11.4.1" data-path="processing-input-data-with-mfdb.html"><a href="processing-input-data-with-mfdb.html#import-temperature-data"><i class="fa fa-check"></i><b>11.4.1</b> Import temperature data</a></li>
<li class="chapter" data-level="11.4.2" data-path="processing-input-data-with-mfdb.html"><a href="processing-input-data-with-mfdb.html#importing-surveycommercial-samples"><i class="fa fa-check"></i><b>11.4.2</b> Importing survey/commercial samples</a></li>
<li class="chapter" data-level="11.4.3" data-path="processing-input-data-with-mfdb.html"><a href="processing-input-data-with-mfdb.html#import-stomach-survey"><i class="fa fa-check"></i><b>11.4.3</b> Import stomach survey</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="processing-input-data-with-mfdb.html"><a href="processing-input-data-with-mfdb.html#querying-data"><i class="fa fa-check"></i><b>11.5</b> Querying data</a></li>
<li class="chapter" data-level="11.6" data-path="processing-input-data-with-mfdb.html"><a href="processing-input-data-with-mfdb.html#uploading-the-datras-database-to-mfdb"><i class="fa fa-check"></i><b>11.6</b> Uploading the DATRAS database to MFDB</a></li>
<li class="chapter" data-level="11.7" data-path="processing-input-data-with-mfdb.html"><a href="processing-input-data-with-mfdb.html#dumping-restoring-a-db"><i class="fa fa-check"></i><b>11.7</b> Dumping / Restoring a DB</a></li>
</ul></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="installing-gadget-from-source.html"><a href="installing-gadget-from-source.html"><i class="fa fa-check"></i><b>A</b> Installing Gadget from source</a><ul>
<li class="chapter" data-level="A.1" data-path="installing-gadget-from-source.html"><a href="installing-gadget-from-source.html#command-line-version"><i class="fa fa-check"></i><b>A.1</b> Command line version</a><ul>
<li class="chapter" data-level="A.1.1" data-path="installing-gadget-from-source.html"><a href="installing-gadget-from-source.html#linux"><i class="fa fa-check"></i><b>A.1.1</b> Linux</a></li>
<li class="chapter" data-level="A.1.2" data-path="installing-gadget-from-source.html"><a href="installing-gadget-from-source.html#mac"><i class="fa fa-check"></i><b>A.1.2</b> Mac</a></li>
<li class="chapter" data-level="A.1.3" data-path="installing-gadget-from-source.html"><a href="installing-gadget-from-source.html#windows"><i class="fa fa-check"></i><b>A.1.3</b> Windows</a></li>
</ul></li>
<li class="chapter" data-level="A.2" data-path="installing-gadget-from-source.html"><a href="installing-gadget-from-source.html#download-compile-and-install"><i class="fa fa-check"></i><b>A.2</b> Download, compile and install</a><ul>
<li class="chapter" data-level="A.2.1" data-path="installing-gadget-from-source.html"><a href="installing-gadget-from-source.html#standard-procedure"><i class="fa fa-check"></i><b>A.2.1</b> Standard procedure</a></li>
<li class="chapter" data-level="A.2.2" data-path="installing-gadget-from-source.html"><a href="installing-gadget-from-source.html#recommended-via-git"><i class="fa fa-check"></i><b>A.2.2</b> Recommended: via Git</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="troubleshooting-gadget-models.html"><a href="troubleshooting-gadget-models.html"><i class="fa fa-check"></i><b>B</b> Troubleshooting Gadget models</a><ul>
<li class="chapter" data-level="B.0.1" data-path="troubleshooting-gadget-models.html"><a href="troubleshooting-gadget-models.html#file-data-gadget-cannot-be-found"><i class="fa fa-check"></i><b>B.0.1</b> File / data / Gadget cannot be found</a></li>
<li class="chapter" data-level="B.0.2" data-path="troubleshooting-gadget-models.html"><a href="troubleshooting-gadget-models.html#fleet-data-likelihood-problems"><i class="fa fa-check"></i><b>B.0.2</b> Fleet / Data / Likelihood problems</a></li>
<li class="chapter" data-level="B.0.3" data-path="troubleshooting-gadget-models.html"><a href="troubleshooting-gadget-models.html#starting-value-is-outside-the-bounds-of-the-parameter"><i class="fa fa-check"></i><b>B.0.3</b> Starting value is outside the bounds of the parameter</a></li>
<li class="chapter" data-level="B.0.4" data-path="troubleshooting-gadget-models.html"><a href="troubleshooting-gadget-models.html#update-gadget-and-rgadget-restart-the-rsession"><i class="fa fa-check"></i><b>B.0.4</b> Update Gadget and Rgadget, restart the Rsession</a></li>
<li class="chapter" data-level="B.1" data-path="troubleshooting-gadget-models.html"><a href="troubleshooting-gadget-models.html#list-of-known-gadget-quirks"><i class="fa fa-check"></i><b>B.1</b> List of known Gadget quirks</a></li>
<li class="chapter" data-level="B.2" data-path="troubleshooting-gadget-models.html"><a href="troubleshooting-gadget-models.html#gadget-is-working-properly-but-results-are-strange"><i class="fa fa-check"></i><b>B.2</b> Gadget is working properly, but results are strange</a><ul>
<li class="chapter" data-level="B.2.1" data-path="troubleshooting-gadget-models.html"><a href="troubleshooting-gadget-models.html#programming-errors"><i class="fa fa-check"></i><b>B.2.1</b> Programming errors</a></li>
<li class="chapter" data-level="B.2.2" data-path="troubleshooting-gadget-models.html"><a href="troubleshooting-gadget-models.html#old-files-hanging-around-in-the-gadget-model-directory"><i class="fa fa-check"></i><b>B.2.2</b> Old files hanging around in the Gadget model directory</a></li>
<li class="chapter" data-level="B.2.3" data-path="troubleshooting-gadget-models.html"><a href="troubleshooting-gadget-models.html#gadget-iterative-gives-errors"><i class="fa fa-check"></i><b>B.2.3</b> Gadget iterative gives errors</a></li>
<li class="chapter" data-level="B.2.4" data-path="troubleshooting-gadget-models.html"><a href="troubleshooting-gadget-models.html#the-gadget-working-directory-is-incorporating-files-from-another-gadget-model"><i class="fa fa-check"></i><b>B.2.4</b> The Gadget working directory is incorporating files from another Gadget model</a></li>
<li class="chapter" data-level="B.2.5" data-path="troubleshooting-gadget-models.html"><a href="troubleshooting-gadget-models.html#your-model-is-not-good"><i class="fa fa-check"></i><b>B.2.5</b> Your model is not good</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>C</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Building models using the Gadget framework</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="setting-up-a-model-for-a-hypothetical-whale-stock" class="section level1">
<h1><span class="header-section-number">10</span> Setting up a model for a hypothetical whale stock</h1>
<p>As usual we will start by setting up a Gadget model directory:</p>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb350-1"></a>gd &lt;-<span class="st"> </span><span class="kw">gadget.variant.dir</span>(<span class="st">&#39;whale-model&#39;</span>)</span></code></pre></div>
<p>and typically we are working with a longer time horizon for whales:</p>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb351-1"></a>schedule &lt;-<span class="st"> </span></span>
<span id="cb351-2"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb351-2"></a><span class="st">  </span><span class="kw">expand.grid</span>(<span class="dt">year =</span> <span class="dv">1880</span><span class="op">:</span><span class="dv">2020</span>, <span class="dt">step =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb351-3"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb351-3"></a><span class="st">  </span><span class="kw">arrange</span>(year)</span>
<span id="cb351-4"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb351-4"></a></span>
<span id="cb351-5"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb351-5"></a><span class="kw">gadgetfile</span>(<span class="st">&#39;Modelfiles/time&#39;</span>,</span>
<span id="cb351-6"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb351-6"></a>           <span class="dt">file_type =</span> <span class="st">&#39;time&#39;</span>,</span>
<span id="cb351-7"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb351-7"></a>           <span class="dt">components =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">firstyear =</span> <span class="kw">min</span>(schedule<span class="op">$</span>year),</span>
<span id="cb351-8"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb351-8"></a>                                  <span class="dt">firststep=</span><span class="dv">1</span>,</span>
<span id="cb351-9"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb351-9"></a>                                  <span class="dt">lastyear=</span><span class="kw">max</span>(schedule<span class="op">$</span>year),</span>
<span id="cb351-10"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb351-10"></a>                                  <span class="dt">laststep=</span><span class="dv">4</span>,</span>
<span id="cb351-11"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb351-11"></a>                                  <span class="dt">notimesteps=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>)))) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">## number of time steps and step length in months</span></span>
<span id="cb351-12"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb351-12"></a><span class="st">  </span><span class="kw">write.gadget.file</span>(gd)</span></code></pre></div>
<p>and they migrate between multiple jurisdictions so let’s add areas to the model:</p>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb352-1"></a><span class="kw">gadgetfile</span>(<span class="st">&#39;Modelfiles/area&#39;</span>,</span>
<span id="cb352-2"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb352-2"></a>           <span class="dt">file_type =</span> <span class="st">&#39;area&#39;</span>,</span>
<span id="cb352-3"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb352-3"></a>           <span class="dt">components =</span> <span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">areas =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,</span>
<span id="cb352-4"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb352-4"></a>                                  <span class="dt">size =</span> <span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>),</span>
<span id="cb352-5"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb352-5"></a>                                  <span class="dt">temperature =</span> schedule <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb352-6"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb352-6"></a><span class="st">                                    </span><span class="kw">expand</span>(year,step, <span class="dt">area =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">temperature =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb352-7"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb352-7"></a><span class="st">                                    </span><span class="kw">arrange</span>(year,step,area)))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb352-8"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb352-8"></a><span class="st">  </span><span class="kw">write.gadget.file</span>(gd)</span></code></pre></div>
<p>To mimic the population dynamics we need to split each stock into two stock components, males and females:</p>
<p>You need to know the initial number at age when at carrying capacity.</p>
<p><span class="math display">\[ N_{a0} = N_0 e^{-aM}\]</span>
where</p>
<p><span class="math display">\[ K = \sum_a N_{a0} = N_0 \frac{1-e^{-aM}}{1-e^{-M}}\]</span>
so
<span class="math display">\[N_0 = K\frac{1-e^{-M}}{1-e^{-aM}}\]</span>
so in the initial conditions we will specify the age factor to be <span class="math inline">\(e^{-aM}\)</span> and the area factor as <span class="math inline">\(N_0\)</span>.</p>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-1"></a>lw.constants &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">estimate=</span><span class="kw">c</span>(<span class="fl">0.001</span>, <span class="dv">3</span>)) <span class="co">## arbitrary lw coeffs</span></span>
<span id="cb353-2"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-2"></a>init.sigma &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">ms=</span><span class="kw">rep</span>(<span class="dv">50</span>, <span class="dv">41</span>))</span>
<span id="cb353-3"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-3"></a></span>
<span id="cb353-4"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-4"></a>whale_m &lt;-<span class="st"> </span></span>
<span id="cb353-5"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-5"></a><span class="st">  </span><span class="kw">gadgetstock</span>(<span class="st">&#39;whale_m&#39;</span>,gd, <span class="dt">missingOkay =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-6"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-6"></a><span class="st">  </span><span class="kw">gadget_update</span>(<span class="st">&#39;stock&#39;</span>,</span>
<span id="cb353-7"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-7"></a>                <span class="dt">livesonareas =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,</span>
<span id="cb353-8"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-8"></a>                <span class="dt">minage =</span> <span class="dv">0</span>,</span>
<span id="cb353-9"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-9"></a>                <span class="dt">maxage =</span> <span class="dv">40</span>,</span>
<span id="cb353-10"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-10"></a>                <span class="dt">minlength =</span> <span class="dv">50</span>,</span>
<span id="cb353-11"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-11"></a>                <span class="dt">maxlength =</span> <span class="dv">1000</span>,</span>
<span id="cb353-12"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-12"></a>                <span class="dt">dl =</span> <span class="dv">50</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-13"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-13"></a><span class="st">  </span><span class="kw">gadget_update</span>(<span class="st">&#39;iseaten&#39;</span>, <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-14"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-14"></a><span class="st">  </span><span class="co">#gadget_update(&#39;naturalmortality&#39;, sprintf(&quot;#%s.M.%s&quot;, .[[1]]$stockname, .[[1]]$minage:.[[1]]$maxage)) %&gt;% </span></span>
<span id="cb353-15"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-15"></a><span class="st">  </span><span class="kw">gadget_update</span>(<span class="st">&#39;doesgrow&#39;</span>, <span class="co">## note to self the order of these parameters make difference</span></span>
<span id="cb353-16"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-16"></a>                <span class="dt">growthparameters=</span><span class="kw">c</span>(<span class="dt">linf=</span><span class="st">&#39;#whale_m.Linf&#39;</span>, </span>
<span id="cb353-17"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-17"></a>                                   <span class="dt">k=</span><span class="kw">to.gadget.formulae</span>(<span class="kw">quote</span>(<span class="fl">0.001</span><span class="op">*</span>whale_m.k)),</span>
<span id="cb353-18"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-18"></a>                                   <span class="dt">alpha =</span> <span class="st">&#39;#whale_m.walpha&#39;</span>,</span>
<span id="cb353-19"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-19"></a>                                   <span class="dt">beta =</span> <span class="st">&#39;#whale_m.wbeta&#39;</span>),</span>
<span id="cb353-20"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-20"></a>                <span class="dt">maxlengthgroupgrowth =</span> <span class="dv">2</span>,</span>
<span id="cb353-21"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-21"></a>                <span class="dt">beta =</span> <span class="kw">to.gadget.formulae</span>(<span class="kw">quote</span>(<span class="dv">10</span><span class="op">*</span>whale.bbin))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-22"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-22"></a><span class="st">  </span><span class="kw">gadget_update</span>(<span class="st">&#39;initialconditions&#39;</span>,</span>
<span id="cb353-23"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-23"></a>                <span class="dt">normalparam =</span> <span class="kw">tibble</span>(<span class="dt">age =</span> .[[<span class="dv">1</span>]]<span class="op">$</span>minage<span class="op">:</span>.[[<span class="dv">1</span>]]<span class="op">$</span>maxage,</span>
<span id="cb353-24"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-24"></a>                                     <span class="dt">area =</span> <span class="dv">1</span>,</span>
<span id="cb353-25"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-25"></a>                                     <span class="dt">age.factor =</span> <span class="kw">parse</span>(<span class="dt">text=</span><span class="kw">sprintf</span>(<span class="st">&#39;exp(-1*(whale_m.M+whale_m_init.F)*%1$s)&#39;</span>,age)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-26"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-26"></a><span class="st">                                       </span>purrr<span class="op">::</span><span class="kw">map</span>(to.gadget.formulae) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-27"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-27"></a><span class="st">                                       </span><span class="kw">unlist</span>(),   </span>
<span id="cb353-28"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-28"></a>                                     <span class="dt">area.factor =</span> <span class="kw">to.gadget.formulae</span>(<span class="kw">quote</span>(prop_m<span class="op">*</span>whale_k<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>whale_m.M))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">40</span><span class="op">*</span>whale_m.M)))),</span>
<span id="cb353-29"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-29"></a>                                     <span class="dt">mean =</span> <span class="kw">von_b_formula</span>(age,<span class="dt">linf=</span><span class="st">&#39;whale_m.Linf&#39;</span>,<span class="dt">k=</span><span class="st">&#39;whale_m.k&#39;</span>,<span class="dt">recl=</span><span class="st">&#39;whale_m.recl&#39;</span>),</span>
<span id="cb353-30"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-30"></a>                                     <span class="dt">stddev =</span> init.sigma<span class="op">$</span>ms[age<span class="op">+</span><span class="dv">1</span>],</span>
<span id="cb353-31"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-31"></a>                                     <span class="dt">alpha =</span> <span class="st">&#39;#whale_m.walpha&#39;</span>,</span>
<span id="cb353-32"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-32"></a>                                     <span class="dt">beta =</span> <span class="st">&#39;#whale_m.wbeta&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-33"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-33"></a><span class="st">                  </span><span class="kw">bind_rows</span>(<span class="kw">expand_grid</span>(<span class="dt">age =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">40</span>,<span class="dt">area=</span><span class="dv">2</span><span class="op">:</span><span class="dv">5</span>,<span class="dt">age.factor=</span><span class="st">&#39;0&#39;</span>,<span class="dt">area.factor=</span><span class="st">&#39;0&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-34"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-34"></a><span class="st">                              </span><span class="kw">mutate</span>(<span class="dt">mean =</span> <span class="kw">von_b_formula</span>(age,<span class="dt">linf=</span><span class="st">&#39;whale_m.Linf&#39;</span>,<span class="dt">k=</span><span class="st">&#39;whale_m.k&#39;</span>,<span class="dt">recl=</span><span class="st">&#39;whale_m.recl&#39;</span>),</span>
<span id="cb353-35"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-35"></a>                                     <span class="dt">stddev =</span> init.sigma<span class="op">$</span>ms[age<span class="op">+</span><span class="dv">1</span>],</span>
<span id="cb353-36"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-36"></a>                                     <span class="dt">alpha =</span> <span class="st">&#39;#whale_m.walpha&#39;</span>,</span>
<span id="cb353-37"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-37"></a>                                     <span class="dt">beta =</span> <span class="st">&#39;#whale_m.wbeta&#39;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-38"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-38"></a><span class="st">  </span><span class="kw">gadget_update</span>(<span class="st">&#39;refweight&#39;</span>,</span>
<span id="cb353-39"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-39"></a>                <span class="dt">data=</span><span class="kw">tibble</span>(<span class="dt">length=</span><span class="kw">seq</span>(.[[<span class="dv">1</span>]]<span class="op">$</span>minlength,.[[<span class="dv">1</span>]]<span class="op">$</span>maxlength,.[[<span class="dv">1</span>]]<span class="op">$</span>dl),</span>
<span id="cb353-40"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-40"></a>                            <span class="dt">mean=</span>lw.constants<span class="op">$</span>estimate[<span class="dv">1</span>]<span class="op">*</span>length<span class="op">^</span>lw.constants<span class="op">$</span>estimate[<span class="dv">2</span>]))</span>
<span id="cb353-41"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-41"></a></span>
<span id="cb353-42"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-42"></a>whale_f &lt;-<span class="st"> </span></span>
<span id="cb353-43"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-43"></a><span class="st">  </span><span class="kw">gadgetstock</span>(<span class="st">&#39;whale_f&#39;</span>,gd, <span class="dt">missingOkay =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-44"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-44"></a><span class="st">  </span><span class="kw">gadget_update</span>(<span class="st">&#39;stock&#39;</span>,</span>
<span id="cb353-45"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-45"></a>                <span class="dt">livesonareas =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,</span>
<span id="cb353-46"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-46"></a>                <span class="dt">minage =</span> <span class="dv">0</span>,</span>
<span id="cb353-47"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-47"></a>                <span class="dt">maxage =</span> <span class="dv">40</span>,</span>
<span id="cb353-48"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-48"></a>                <span class="dt">minlength =</span> <span class="dv">50</span>,</span>
<span id="cb353-49"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-49"></a>                <span class="dt">maxlength =</span> <span class="dv">1200</span>,</span>
<span id="cb353-50"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-50"></a>                <span class="dt">dl =</span> <span class="dv">50</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-51"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-51"></a><span class="st">  </span><span class="kw">gadget_update</span>(<span class="st">&#39;iseaten&#39;</span>, <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-52"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-52"></a><span class="st">  </span><span class="co">#gadget_update(&#39;naturalmortality&#39;, sprintf(&quot;#%s.M.%s&quot;, .[[1]]$stockname, .[[1]]$minage:.[[1]]$maxage)) %&gt;% </span></span>
<span id="cb353-53"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-53"></a><span class="st">  </span><span class="kw">gadget_update</span>(<span class="st">&#39;doesgrow&#39;</span>, <span class="co">## note to self the order of these parameters make difference</span></span>
<span id="cb353-54"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-54"></a>                <span class="dt">growthparameters=</span><span class="kw">c</span>(<span class="dt">linf=</span><span class="st">&#39;#whale_f.Linf&#39;</span>, </span>
<span id="cb353-55"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-55"></a>                                   <span class="dt">k=</span><span class="kw">to.gadget.formulae</span>(<span class="kw">quote</span>(<span class="fl">0.001</span><span class="op">*</span>whale_f.k)),</span>
<span id="cb353-56"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-56"></a>                                   <span class="dt">alpha =</span> <span class="st">&#39;#whale_f.walpha&#39;</span>,</span>
<span id="cb353-57"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-57"></a>                                   <span class="dt">beta =</span> <span class="st">&#39;#whale_f.wbeta&#39;</span>),</span>
<span id="cb353-58"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-58"></a>                <span class="dt">maxlengthgroupgrowth =</span> <span class="dv">2</span>,</span>
<span id="cb353-59"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-59"></a>                <span class="dt">beta =</span> <span class="kw">to.gadget.formulae</span>(<span class="kw">quote</span>(<span class="dv">10</span><span class="op">*</span>whale.bbin))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-60"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-60"></a><span class="st">  </span><span class="kw">gadget_update</span>(<span class="st">&#39;initialconditions&#39;</span>,</span>
<span id="cb353-61"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-61"></a>                <span class="dt">normalparam =</span> <span class="kw">tibble</span>(<span class="dt">age =</span> .[[<span class="dv">1</span>]]<span class="op">$</span>minage<span class="op">:</span>.[[<span class="dv">1</span>]]<span class="op">$</span>maxage,</span>
<span id="cb353-62"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-62"></a>                                     <span class="dt">area =</span> <span class="dv">1</span>,</span>
<span id="cb353-63"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-63"></a>                                     <span class="dt">age.factor =</span> <span class="kw">parse</span>(<span class="dt">text=</span><span class="kw">sprintf</span>(<span class="st">&#39;exp(-1*(whale_f.M+whale_f_init.F)*%1$s)&#39;</span>,age)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-64"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-64"></a><span class="st">                                       </span>purrr<span class="op">::</span><span class="kw">map</span>(to.gadget.formulae) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-65"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-65"></a><span class="st">                                       </span><span class="kw">unlist</span>(),   </span>
<span id="cb353-66"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-66"></a>                                     <span class="dt">area.factor =</span> <span class="kw">to.gadget.formulae</span>(<span class="kw">quote</span>((<span class="dv">1</span><span class="op">-</span>prop_m)<span class="op">*</span>whale_k<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span>whale_f.M))<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">40</span><span class="op">*</span>whale_f.M)))),</span>
<span id="cb353-67"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-67"></a>                                     <span class="dt">mean =</span> <span class="kw">von_b_formula</span>(age,<span class="dt">linf=</span><span class="st">&#39;whale_f.Linf&#39;</span>,<span class="dt">k=</span><span class="st">&#39;whale_f.k&#39;</span>,<span class="dt">recl=</span><span class="st">&#39;whale_f.recl&#39;</span>),</span>
<span id="cb353-68"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-68"></a>                                     <span class="dt">stddev =</span> init.sigma<span class="op">$</span>ms[age<span class="op">+</span><span class="dv">1</span>],</span>
<span id="cb353-69"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-69"></a>                                     <span class="dt">alpha =</span> <span class="st">&#39;#whale_f.walpha&#39;</span>,</span>
<span id="cb353-70"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-70"></a>                                     <span class="dt">beta =</span> <span class="st">&#39;#whale_f.wbeta&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-71"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-71"></a><span class="st">                  </span><span class="kw">bind_rows</span>(<span class="kw">expand_grid</span>(<span class="dt">age =</span> <span class="dv">0</span><span class="op">:</span><span class="dv">40</span>,<span class="dt">area=</span><span class="dv">2</span><span class="op">:</span><span class="dv">5</span>,<span class="dt">age.factor=</span><span class="st">&#39;0&#39;</span>,<span class="dt">area.factor=</span><span class="st">&#39;0&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-72"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-72"></a><span class="st">                              </span><span class="kw">mutate</span>(<span class="dt">mean =</span> <span class="kw">von_b_formula</span>(age,<span class="dt">linf=</span><span class="st">&#39;whale_f.Linf&#39;</span>,<span class="dt">k=</span><span class="st">&#39;whale_f.k&#39;</span>,<span class="dt">recl=</span><span class="st">&#39;whale_f.recl&#39;</span>),</span>
<span id="cb353-73"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-73"></a>                                     <span class="dt">stddev =</span> init.sigma<span class="op">$</span>ms[age<span class="op">+</span><span class="dv">1</span>],</span>
<span id="cb353-74"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-74"></a>                                     <span class="dt">alpha =</span> <span class="st">&#39;#whale_f.walpha&#39;</span>,</span>
<span id="cb353-75"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-75"></a>                                     <span class="dt">beta =</span> <span class="st">&#39;#whale_f.wbeta&#39;</span>))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb353-76"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-76"></a><span class="st">  </span><span class="kw">gadget_update</span>(<span class="st">&#39;refweight&#39;</span>,</span>
<span id="cb353-77"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-77"></a>                <span class="dt">data=</span><span class="kw">tibble</span>(<span class="dt">length=</span><span class="kw">seq</span>(.[[<span class="dv">1</span>]]<span class="op">$</span>minlength,.[[<span class="dv">1</span>]]<span class="op">$</span>maxlength,.[[<span class="dv">1</span>]]<span class="op">$</span>dl),</span>
<span id="cb353-78"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb353-78"></a>                            <span class="dt">mean=</span>lw.constants<span class="op">$</span>estimate[<span class="dv">1</span>]<span class="op">*</span>length<span class="op">^</span>lw.constants<span class="op">$</span>estimate[<span class="dv">2</span>]))</span></code></pre></div>
<p>This sets up two stock, male and female part of the stocks. Two important parts remain in the population dynamics to capture what is needed, migration and births. Let’s start with the birth function. Only females give birth so the birth process only applies to that stock:</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-1"></a>whale_f &lt;-<span class="st"> </span></span>
<span id="cb354-2"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-2"></a><span class="st">  </span>whale_f <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb354-3"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-3"></a><span class="st">  </span><span class="kw">gadget_update</span>(<span class="st">&quot;doesspawn&quot;</span>,</span>
<span id="cb354-4"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-4"></a>                <span class="dt">spawnsteps =</span> <span class="dv">1</span>,</span>
<span id="cb354-5"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-5"></a>                <span class="dt">spawnareas =</span> <span class="dv">1</span>,</span>
<span id="cb354-6"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-6"></a>                <span class="dt">firstspawnyear =</span> <span class="dv">1881</span>,</span>
<span id="cb354-7"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-7"></a>                <span class="dt">spawnstocksandratios =</span> <span class="kw">list</span>(<span class="dt">stock1 =</span> <span class="st">&quot;whale_f&quot;</span>, <span class="dt">ratio1 =</span> <span class="fl">0.5</span>, <span class="dt">stock2 =</span> <span class="st">&#39;whale_m&#39;</span>, <span class="dt">ratio2 =</span> <span class="fl">0.5</span>),</span>
<span id="cb354-8"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-8"></a>                <span class="dt">proportionfunction =</span> <span class="kw">list</span>(<span class="dt">sel_func =</span> <span class="st">&#39;constant&#39;</span>, <span class="dt">alpha =</span> <span class="dv">1</span>),</span>
<span id="cb354-9"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-9"></a>                <span class="dt">mortalityfunction =</span> <span class="kw">list</span>(<span class="dt">sel_func =</span> <span class="st">&#39;constant&#39;</span>, <span class="dt">alpha =</span> <span class="dv">0</span>),</span>
<span id="cb354-10"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-10"></a>                <span class="dt">weightlossfunction =</span> <span class="kw">list</span>(<span class="dt">sel_func =</span> <span class="st">&#39;constant&#39;</span>, <span class="dt">alpha =</span> <span class="dv">0</span>),</span>
<span id="cb354-11"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-11"></a>                <span class="dt">recruitment =</span> <span class="kw">list</span>(<span class="dt">spawn_function =</span> <span class="st">&#39;baleen&#39;</span>, </span>
<span id="cb354-12"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-12"></a>                                   <span class="dt">num_births =</span> <span class="st">&#39;#whale_num_births&#39;</span>, </span>
<span id="cb354-13"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-13"></a>                                   <span class="dt">resil_a =</span> <span class="st">&#39;#whale_resil.a&#39;</span>,</span>
<span id="cb354-14"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-14"></a>                                   <span class="co">## everything is in multiples of 1e4</span></span>
<span id="cb354-15"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-15"></a>                                   <span class="dt">K =</span> <span class="kw">to.gadget.formulae</span>(<span class="kw">quote</span>(whale_k<span class="op">*</span><span class="fl">1e4</span>)),  </span>
<span id="cb354-16"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-16"></a>                                   <span class="dt">z =</span> <span class="st">&#39;#whale_z&#39;</span>), </span>
<span id="cb354-17"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-17"></a>                <span class="dt">stockparameters =</span> <span class="kw">list</span>(<span class="dt">mean =</span> <span class="st">&#39;#whale_f.recl&#39;</span>,</span>
<span id="cb354-18"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-18"></a>                                       <span class="dt">stddev =</span> <span class="st">&#39;#whale_f.recsd&#39;</span>,</span>
<span id="cb354-19"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-19"></a>                                       <span class="dt">alpha =</span> <span class="st">&#39;#whale_f.walpha&#39;</span>,</span>
<span id="cb354-20"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb354-20"></a>                                       <span class="dt">beta =</span> <span class="st">&#39;#whale_f.wbeta&#39;</span>))</span></code></pre></div>
<p>Migratio: area 1 is a spawning area, areas 2 to 5 are feeding areas.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb355-1"></a>whale_f &lt;-</span>
<span id="cb355-2"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb355-2"></a><span class="st">  </span>whale_f <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb355-3"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb355-3"></a><span class="st">  </span><span class="kw">gadget_update</span>(<span class="st">&#39;doesmigrate&#39;</span>,</span>
<span id="cb355-4"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb355-4"></a>                <span class="dt">yearstepfile =</span> <span class="st">&#39;Modelfiles/migrationtime&#39;</span>,</span>
<span id="cb355-5"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb355-5"></a>                <span class="dt">defineratios =</span> <span class="st">&#39;Modelfiles/migration&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb355-6"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb355-6"></a><span class="st">  </span><span class="kw">write.gadget.file</span>(gd)</span>
<span id="cb355-7"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb355-7"></a></span>
<span id="cb355-8"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb355-8"></a></span>
<span id="cb355-9"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb355-9"></a>whale_m &lt;-<span class="st"> </span></span>
<span id="cb355-10"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb355-10"></a><span class="st">  </span>whale_m <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb355-11"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb355-11"></a><span class="st">  </span><span class="kw">gadget_update</span>(<span class="st">&#39;doesmigrate&#39;</span>,</span>
<span id="cb355-12"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb355-12"></a>                <span class="dt">yearstepfile =</span> <span class="st">&#39;Modelfiles/migrationtime&#39;</span>,</span>
<span id="cb355-13"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb355-13"></a>                <span class="dt">defineratios =</span> <span class="st">&#39;Modelfiles/migration&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb355-14"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb355-14"></a><span class="st">  </span><span class="kw">write.gadget.file</span>(gd)</span></code></pre></div>
<p>Let’s define the migration matricies from spaning to feeding areas:</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-1"></a>feeding_migration &lt;-<span class="st"> </span></span>
<span id="cb356-2"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-2"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">prop =</span> <span class="kw">sprintf</span>(<span class="st">&#39;#feed_area_prop.%s&#39;</span>,to))</span>
<span id="cb356-3"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-3"></a></span>
<span id="cb356-4"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-4"></a>spawn_migration &lt;-<span class="st"> </span></span>
<span id="cb356-5"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-5"></a><span class="st">  </span><span class="kw">tibble</span>(<span class="dt">from =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">prop =</span> <span class="dv">1</span>)</span>
<span id="cb356-6"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-6"></a></span>
<span id="cb356-7"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-7"></a>no_migration &lt;-<span class="st"> &quot;&quot;</span></span>
<span id="cb356-8"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-8"></a></span>
<span id="cb356-9"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-9"></a><span class="kw">gadgetfile</span>(<span class="st">&#39;Modelfiles/migration&#39;</span>,</span>
<span id="cb356-10"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-10"></a>           <span class="dt">components =</span> <span class="kw">list</span>(<span class="dt">migrationmatrix =</span> <span class="kw">list</span>(</span>
<span id="cb356-11"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-11"></a>             <span class="dt">name =</span> <span class="st">&#39;feeding&#39;</span>,</span>
<span id="cb356-12"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-12"></a>             feeding_migration <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unite</span>(tmp,from<span class="op">:</span>prop,<span class="dt">sep =</span> <span class="st">&quot; &quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>.<span class="op">$</span>tmp <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">paste</span>(<span class="dt">collapse =</span> <span class="st">&#39;</span><span class="ch">\n\t</span><span class="st">&#39;</span>)),</span>
<span id="cb356-13"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-13"></a>             <span class="dt">migrationmatrix =</span><span class="kw">list</span>(</span>
<span id="cb356-14"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-14"></a>               <span class="dt">name =</span> <span class="st">&#39;spawning&#39;</span>,</span>
<span id="cb356-15"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-15"></a>               spawn_migration <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">unite</span>(tmp,from<span class="op">:</span>prop,<span class="dt">sep =</span> <span class="st">&quot; &quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span>.<span class="op">$</span>tmp <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">paste</span>(<span class="dt">collapse =</span> <span class="st">&#39;</span><span class="ch">\n\t</span><span class="st">&#39;</span>)),</span>
<span id="cb356-16"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-16"></a>             <span class="dt">migrationmatrix =</span> <span class="kw">list</span>(<span class="dt">name =</span> <span class="st">&#39;stay_put&#39;</span>, </span>
<span id="cb356-17"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-17"></a>                                    no_migration)</span>
<span id="cb356-18"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-18"></a>           )) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb356-19"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb356-19"></a><span class="st">  </span><span class="kw">write.gadget.file</span>(gd)</span></code></pre></div>
<p>and the schedule when each matrix is used:</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb357-1"></a><span class="kw">gadgetfile</span>(<span class="st">&#39;Modelfiles/migrationtime&#39;</span>,</span>
<span id="cb357-2"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb357-2"></a>           <span class="dt">file_type =</span> <span class="st">&#39;data&#39;</span>,</span>
<span id="cb357-3"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb357-3"></a>           <span class="dt">components =</span> <span class="kw">list</span>(schedule <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb357-4"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb357-4"></a><span class="st">                               </span><span class="co">#filter(step %in% c(1,2)) %&gt;% ## migration occurs at the beginning of the timestep</span></span>
<span id="cb357-5"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb357-5"></a><span class="st">                               </span><span class="kw">mutate</span>(<span class="dt">defineratios =</span> <span class="kw">case_when</span>(step <span class="op">==</span><span class="st"> </span><span class="dv">2</span><span class="op">~</span><span class="st">&#39;feeding&#39;</span>,</span>
<span id="cb357-6"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb357-6"></a>                                                               step <span class="op">==</span><span class="st"> </span><span class="dv">1</span><span class="op">~</span><span class="st">&#39;spawning&#39;</span>,</span>
<span id="cb357-7"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb357-7"></a>                                                               <span class="ot">TRUE</span><span class="op">~</span><span class="st">&#39;stay_put&#39;</span>)))) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb357-8"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb357-8"></a><span class="st">  </span><span class="kw">write.gadget.file</span>(gd)</span></code></pre></div>
<p>Setting up fleets with random numbers</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-1"></a>whale_catch &lt;-<span class="st"> </span></span>
<span id="cb358-2"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-2"></a><span class="st">  </span>schedule <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb358-3"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">area =</span> <span class="dv">3</span>, </span>
<span id="cb358-4"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-4"></a>         <span class="dt">number =</span> <span class="kw">rbinom</span>(<span class="kw">n</span>(),<span class="dv">50</span>,<span class="kw">runif</span>(<span class="kw">n</span>())),</span>
<span id="cb358-5"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-5"></a>         <span class="dt">number =</span> <span class="kw">ifelse</span>(step <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, <span class="dv">0</span>, number))</span>
<span id="cb358-6"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-6"></a>whale_catch &lt;-<span class="st"> </span></span>
<span id="cb358-7"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-7"></a><span class="st">  </span><span class="kw">structure</span>(whale_catch,<span class="dt">area_group =</span> <span class="kw">list</span>(<span class="st">`</span><span class="dt">3</span><span class="st">`</span>=<span class="st"> </span><span class="dv">3</span>))</span>
<span id="cb358-8"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-8"></a></span>
<span id="cb358-9"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-9"></a></span>
<span id="cb358-10"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-10"></a><span class="kw">gadgetfleet</span>(<span class="st">&#39;Modelfiles/fleet&#39;</span>,gd,<span class="dt">missingOkay =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb358-11"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-11"></a><span class="st">  </span><span class="kw">gadget_update</span>(<span class="st">&#39;numberfleet&#39;</span>,</span>
<span id="cb358-12"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-12"></a>                <span class="dt">name =</span> <span class="st">&#39;whale_fleet&#39;</span>,</span>
<span id="cb358-13"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-13"></a>                <span class="dt">livesonareas =</span> <span class="dv">3</span>,</span>
<span id="cb358-14"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-14"></a>                <span class="dt">suitability =</span> </span>
<span id="cb358-15"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-15"></a>                  <span class="kw">list</span>(<span class="dt">whale_m=</span><span class="kw">list</span>(<span class="dt">type=</span><span class="st">&#39;function&#39;</span>,<span class="dt">suit_func =</span> <span class="st">&#39;exponentiall50&#39;</span>,<span class="dt">alpha =</span> <span class="st">&quot;#whale_fleet.alpha&quot;</span>, <span class="dt">l50 =</span> <span class="st">&quot;#whale_fleet.l50&quot;</span>),</span>
<span id="cb358-16"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-16"></a>                       <span class="dt">whale_f=</span><span class="kw">list</span>(<span class="dt">type=</span><span class="st">&#39;function&#39;</span>,<span class="dt">suit_func =</span> <span class="st">&#39;exponentiall50&#39;</span>,<span class="dt">alpha =</span> <span class="st">&quot;#whale_fleet.alpha&quot;</span>, <span class="dt">l50 =</span> <span class="st">&quot;#whale_fleet.l50&quot;</span>)),</span>
<span id="cb358-17"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-17"></a>                <span class="dt">data =</span> whale_catch) -&gt;<span class="st"> </span>tmp</span>
<span id="cb358-18"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-18"></a>tmp<span class="op">$</span>component<span class="op">$</span>livesonareas &lt;-<span class="st"> </span><span class="dv">3</span> <span class="co"># weird bug</span></span>
<span id="cb358-19"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-19"></a>tmp<span class="op">$</span>component<span class="op">$</span>amount<span class="op">$</span>data<span class="op">$</span>area &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb358-20"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-20"></a>tmp <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb358-21"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb358-21"></a><span class="st">  </span><span class="kw">write.gadget.file</span>(gd)</span></code></pre></div>
<div id="run-gadget-and-set-initial-parameters" class="section level3">
<h3><span class="header-section-number">10.0.1</span> Run Gadget and set initial parameters</h3>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb359-1"></a><span class="kw">gadget_evaluate</span>(gd, <span class="dt">log =</span> <span class="st">&#39;init.log&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;whale-model&quot;
## attr(,&quot;mainfile&quot;)
## [1] &quot;main&quot;
## attr(,&quot;class&quot;)
## [1] &quot;gadget.variant&quot; &quot;list&quot;</code></pre>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-1"></a><span class="kw">read.gadget.parameters</span>(<span class="kw">paste</span>(gd,<span class="st">&#39;params.out&#39;</span>,<span class="dt">sep=</span><span class="st">&#39;/&#39;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-2"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-2"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;_f.Linf&#39;</span>,<span class="dv">1100</span>,<span class="dt">lower =</span> <span class="dv">800</span>, <span class="dt">upper =</span> <span class="dv">1400</span>, <span class="dt">optimise =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-3"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-3"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;_m.Linf&#39;</span>,<span class="dv">900</span>,<span class="dt">lower =</span> <span class="dv">800</span>, <span class="dt">upper =</span> <span class="dv">1400</span>, <span class="dt">optimise =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-4"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-4"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;</span><span class="ch">\\</span><span class="st">.k$&#39;</span>,<span class="dv">180</span>,<span class="dt">lower =</span> <span class="dv">150</span>, <span class="dt">upper =</span> <span class="dv">300</span>, <span class="dt">optimise =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-5"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-5"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;_k$&#39;</span>,<span class="dv">1000</span>,<span class="dt">lower =</span> <span class="dv">5</span>, <span class="dt">upper =</span> <span class="dv">3000</span>, <span class="dt">optimise =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-6"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-6"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;</span><span class="ch">\\</span><span class="st">.bbin&#39;</span>,<span class="dv">180</span>,<span class="dt">lower =</span> <span class="dv">150</span>, <span class="dt">upper =</span> <span class="dv">300</span>, <span class="dt">optimise =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-7"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-7"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;prop_m&#39;</span>,<span class="fl">0.5</span>,<span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">1</span>, <span class="dt">optimise =</span> <span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-8"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-8"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;init.F&#39;</span>,<span class="dv">0</span>,<span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">1</span>, <span class="dt">optimise =</span> <span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-9"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-9"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;recl&#39;</span>,<span class="dv">50</span>,<span class="dt">lower =</span> <span class="dv">50</span>, <span class="dt">upper =</span> <span class="dv">300</span>, <span class="dt">optimise =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-10"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-10"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;</span><span class="ch">\\</span><span class="st">.k$&#39;</span>,<span class="dv">180</span>,<span class="dt">lower =</span> <span class="dv">150</span>, <span class="dt">upper =</span> <span class="dv">300</span>, <span class="dt">optimise =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-11"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-11"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;</span><span class="ch">\\</span><span class="st">.walpha$&#39;</span>,<span class="fl">0.001</span>,<span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">1</span>, <span class="dt">optimise =</span> <span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-12"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-12"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;</span><span class="ch">\\</span><span class="st">.wbeta&#39;</span>,<span class="dv">3</span>,<span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">4</span>, <span class="dt">optimise =</span> <span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-13"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-13"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;</span><span class="ch">\\</span><span class="st">.recsd$&#39;</span>,<span class="dv">50</span>,<span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">300</span>, <span class="dt">optimise =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-14"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-14"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;</span><span class="ch">\\</span><span class="st">.M$&#39;</span>,<span class="fl">0.16</span>,<span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">1</span>, <span class="dt">optimise =</span> <span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-15"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-15"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;num_births&#39;</span>,<span class="dv">2</span>,<span class="dt">lower =</span> <span class="dv">1</span>, <span class="dt">upper =</span> <span class="dv">2</span>, <span class="dt">optimise =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-16"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-16"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;feed_area_prop&#39;</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>,<span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">1</span>, <span class="dt">optimise =</span> <span class="dv">0</span>) <span class="op">%&gt;%</span></span>
<span id="cb361-17"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-17"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;resil.a&#39;</span>,<span class="fl">1.6</span>,<span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">10</span>, <span class="dt">optimise =</span> <span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-18"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-18"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;_z&#39;</span>,<span class="dv">2</span>,<span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">3</span>, <span class="dt">optimise =</span> <span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-19"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-19"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;fleet.alpha&#39;</span>,<span class="fl">0.08</span>,<span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> <span class="dv">1</span>, <span class="dt">optimise =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-20"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-20"></a><span class="st">  </span><span class="kw">init_guess</span>(<span class="st">&#39;fleet.l50&#39;</span>,<span class="dv">300</span>,<span class="dt">lower =</span> <span class="dv">150</span>, <span class="dt">upper =</span> <span class="dv">600</span>, <span class="dt">optimise =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb361-21"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-21"></a><span class="st">  </span><span class="kw">write.gadget.parameters</span>(<span class="kw">paste</span>(gd,<span class="st">&#39;params.in&#39;</span>,<span class="dt">sep=</span><span class="st">&#39;/&#39;</span>))</span>
<span id="cb361-22"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-22"></a></span>
<span id="cb361-23"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-23"></a></span>
<span id="cb361-24"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-24"></a></span>
<span id="cb361-25"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-25"></a></span>
<span id="cb361-26"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-26"></a></span>
<span id="cb361-27"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-27"></a></span>
<span id="cb361-28"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-28"></a></span>
<span id="cb361-29"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-29"></a></span>
<span id="cb361-30"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-30"></a></span>
<span id="cb361-31"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb361-31"></a><span class="kw">gadget_evaluate</span>(gd,<span class="dt">params.in =</span> <span class="st">&#39;params.in&#39;</span>, <span class="dt">log =</span> <span class="st">&#39;run.log&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;whale-model&quot;
## attr(,&quot;mainfile&quot;)
## [1] &quot;main&quot;
## attr(,&quot;class&quot;)
## [1] &quot;gadget.variant&quot; &quot;list&quot;</code></pre>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb363-1"></a>fit &lt;-<span class="st"> </span><span class="kw">gadget.fit</span>(<span class="dt">gd =</span> gd, <span class="dt">wgts =</span> <span class="ot">NULL</span>, <span class="dt">params.file =</span> <span class="st">&#39;params.in&#39;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Reading input data&quot;
## [1] &quot;Running Gadget&quot;
## [1] &quot;Reading output files&quot;
## [1] &quot;Gathering results&quot;
## [1] &quot;Merging input and output&quot;</code></pre>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="setting-up-a-model-for-a-hypothetical-whale-stock.html#cb365-1"></a><span class="kw">plot</span>(fit, <span class="dt">data=</span> <span class="st">&#39;res.by.year&#39;</span>, <span class="dt">type =</span> <span class="st">&#39;num.total&#39;</span>)</span></code></pre></div>
<p><img src="minke_whale_model_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="marine-mammals.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="processing-input-data-with-mfdb.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/hafro/gadget-course/edit/master/minke_whale_model.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/hafro/gadget-course/blob/master/minke_whale_model.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
